{{#admin_group_admin}}

<style>
.bigemoji{font-size:5em}
.faces::after{content:"ðŸ¤•";animation-name:faces;animation-duration:1s}
.emojianim::after{animation-timing-function:linear;animation-iteration-count:infinite}
@keyframes faces{10%{content:"ðŸ˜©"}20%{content:"ðŸ˜«"}30%{content:"ðŸ˜ª"}40%{content:"ðŸ˜´"}50%{content:"ðŸ˜µ"}60%{content:"ðŸ˜¦"}70%{content:"ðŸ˜¢"}80%{content:"ðŸ˜­"}90%{content:"ðŸ¤’"}}
.a_reset{font-family:Arial!important;font-size:14px!important}
.a_h2{font-size:5em!important;font-weight:700!important}
.a_h4{font-size:3em!important;font-weight:700!important}
.a_h5{font-size:2em!important;font-weight:700!important}
.extrapadding{padding:5px;border-radius:5px}
.nowrap{white-space:nowrap}
.protect{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block;width:10em;line-height:12px}
#admin_main .row{margin-bottom:6px}
#admin_main {padding-top:5px}
#admin_main,#admin_main h2,#admin_main h4,#admin_main h5{font-family:Arial!important}
#admin_main {font-size:14px!important}
#a_rotate_device{display:none}
[touch="true"] #a_rotate_device{display:block}
#emojis{cursor:crosshair}
/* Summernote plugins */
.panel-heading.note-toolbar .note-font .dropdown-menu,.panel-heading.note-toolbar .note-style .dropdown-menu{min-width:245px;padding:5px}
.panel-heading.note-toolbar .note-font .dropdown-menu>div:first-child,.panel-heading.note-toolbar .note-style .dropdown-menu>div:first-child{margin-right:5px}
.note-add-text-tags-btn{font-family:"Times New Roman",serif;min-width:30px}
</style>

<div id="admin_main" class="row center black white-text" style="display:none;margin:0!important">

  <!-- device rotation note -->
  <div id="a_rotate_device" class="row center" style="padding-top:3px">
    {{ l.a_rotate_device }}
  </div>

  <!-- external services buttons -->
  <div class="row center black hide-on-small-only">
    <div class="extrapadding hide-on-small-only" style="padding-top:3px">
      <a style="margin:2px;" class="tooltipped waves-effect teal waves-light btn" target="_blank" rel="noopener"
        data-position="top" data-tooltip="{{ l.a_google_account_ttip }}" href="https://myaccount.google.com/dashboard">
        <i class="fab fa-google"></i>
        {{ l.a_google_account }}</a>
      <a style="margin:2px;" class="tooltipped waves-effect teal waves-light btn" target="_blank" rel="noopener"
        data-position="top" data-tooltip="{{ l.a_google_password_ttip }}" href="https://passwords.google.com">
        <i class="fab fa-google"></i>
        {{ l.a_google_password }}</a>
      <a style="margin:2px;" class="tooltipped waves-effect teal waves-light btn" target="_blank" rel="noopener"
        data-position="top" data-tooltip="{{ l.a_google_search_ttip }}"
        href="https://search.google.com/search-console?resource_id={{ canonical_url }}">
        <i class="fab fa-google"></i>
        {{ l.a_google_search }}</a>
      <a style="margin:2px;" class="tooltipped waves-effect teal waves-light btn" target="_blank" rel="noopener"
        data-position="top" data-tooltip="{{ l.a_google_analytics_ttip }}"
        href="{{#google.analytics}}{{ google.analytics }}{{/google.analytics}}{{^google.analytics}}https://analytics.google.com/analytics/web/{{/google.analytics}}">
        <i class="fab fa-google"></i>
        {{ l.a_google_analytics }}</a>
      <a style="margin:2px;" class="tooltipped waves-effect pink waves-light btn" target="_blank" rel="noopener"
        data-position="top" data-tooltip="{{ l.a_onesignal_ttip }}" href="https://onesignal.com">
        <i class="fas fa-bell"></i>
        {{ l.a_onesignal }}</a>
      <a style="margin:2px;" class="tooltipped waves-effect red waves-light btn" data-position="top"
        data-tooltip="{{ l.a_google_logout_ttip }}" href="https://www.google.com/accounts/Logout">
        <i class="fab fa-google"></i>
        {{ l.a_google_logout }}</a>
    </div>
  </div>

  <!-- admin grid -->
  <div class="row grid" style="overflow:hidden" style="padding-top:3px">

    <!-- DATA -->
    <div class="col l4 m6 s12">
      <div class="row center extrapadding">
        <h5>{{ l.a_locales }}&nbsp;<span id="csv_ping" class="mono">&nbsp;</span></h5>
        <p id="a_update_info"></p>
        <div class="col s12 white">
          <label>{{ l.a_sites }}</label>
          <select id="SiteSelect">
            <option value="" disabled selected>&hellip;</option>
            {{#multisite_names}}
            <option value="{{.}}">{{.}}</option>
            {{/multisite_names}}
          </select>
        </div>
        <div id="domains" class="container"></div>
        <a id="a_emoji" style="margin:5px" class="waves-effect blue waves btn faces emojianim"></a>
        <a id="a_summernote" style="margin:5px" class="tooltipped waves-effect orange waves-light btn"
          data-position="top" data-tooltip="{{ l.a_summernote_ttip }}">
          <i class="fas fa-edit"></i>
          {{ l.a_summernote }}</a>&nbsp;<span id="summer_ping" class="mono">&nbsp;</span>
      </div>
    </div>

    <!-- CACHE -->
    <div class="col l4 m6 s12">
      <div class="row center extrapadding">
        <h5>{{ l.a_cache }}</h5>
        <div class="container">
          <span class="nowrap">default: {{ cache_profiles.default }}</span>
          &nbsp;&nbsp;
          <span class="nowrap">CSV: {{ cache_profiles.csv }}</span>
          &nbsp;&nbsp;
          <span class="nowrap">{{ l.a_limiter }}: {{ CONST.LIMITER_MAXIMUM }}x / {{ cache_profiles.limiter }}</span>
          &nbsp;&nbsp;
          <span class="nowrap">{{ l.a_webpage }}: {{ cache_profiles.page }}</span>
        </div>
        <div class="row center">
          <a id="a_update" style="margin:5px;" class="tooltipped waves-effect red waves-light btn" data-position="top"
            data-tooltip="{{ l.a_update_ttip }}">
            <i class="fab fa-google-drive"></i>
            {{ l.a_update }}</a>
          <a id="a_flush" style="margin:5px;" class="tooltipped waves-effect red waves-light btn" data-position="top"
            data-tooltip="{{ l.a_flush_ttip }}">
            <i class="fas fa-cloud-sun"></i>
            {{ l.a_flush }}</a>
        </div>
      </div>
      <div class="row center white hide-on-small-only">
        <div class="col s12 white">
          <label>{{ l.a_remotefns }}</label>
          <select id="RemoteFnSelect">
            <option value="" disabled selected>&hellip;</option>
            <option value="CoreUpdateRemote">Core Update</option>
            <option value="FlushCacheRemote">Flush Cache</option>
          </select>
        </div>
      </div>
    </div>

    <!-- PERMISSIONS -->
    <div class="col l4 m6 s12">
      <div class="row center extrapadding">
        <div class="white-text">
          <h5>{{ l.a_groups_permissions }}</h5>
          <div class="row center">
            <a id="a_logout" class="tooltipped waves-effect green waves-light btn" data-position="top"
              data-tooltip="{{ l.a_logout_ttip }}">
              <i class="fas fa-sign-out-alt"></i>
              {{ l.a_logout }}</a>
          </div>
          <div class="row center hide-on-small-only">
            <strong>OWNER / ADMIN</strong>
            <div class="container">
              <p class="orange-text">
                {{#admin_groups.admin}}{{ . }} {{/admin_groups.admin}}
                {{^admin_groups.admin}}<i class="red-text fas fa-times"></i>{{/admin_groups.admin}}
              </p>
            </div>
            <strong>DEFAULT</strong>
            <div class="container">
              <p class="orange-text">
                {{#admin_groups.default}}{{ . }} {{/admin_groups.default}}
                {{^admin_groups.default}}<i class="red-text fas fa-times"></i>{{/admin_groups.default}}
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- GOOGLE -->
    <div class="col l4 m6 s12">
      <div class="row center extrapadding hide-on-small-only">
        <div class="white-text">
          <h5>{{ l.a_google }}</h5>
          <ul class="mono">
            <li>Project: {{ gcp_project_id }}
              {{^gcp_project_id}}<i class="red-text fas fa-times"></i>{{/gcp_project_id}}</li>
            <li>Google Maps query: {{ google.map_query }}
              {{^google.map_query}}<i class="red-text fas fa-times"></i>{{/google.map_query}}</li>
            <li>Google Analytics: {{ google.ua }}
              {{^google.ua}}<i class="red-text fas fa-times"></i>{{/google.ua}}</li>
            <li>Google Maps API key: <span title="{{ google.mapsapi_key }}"
                class="protect">{{ google.mapsapi_key }}</span>
              {{^google.mapsapi_key}}<i class="red-text fas fa-times"></i>{{/google.mapsapi_key}}</li>
            <li>PageSpeed Insights API key: <span title="{{ google.pagespeedinsights_key }}" class="protect">{{
            google.pagespeedinsights_key }}</span>
              {{^google.pagespeedinsights_key}}<i class="red-text fas fa-times"></i>{{/google.pagespeedinsights_key}}
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- CHANGELOG -->
    <div class="col l4 m6 hide-on-small-only">
      <div class="row center extrapadding">
        <h5>{{ l.a_changes }}</h5>
        <div class="row grey-text" style="margin-top:1em">
          <div class="grey-text left-align container">
            {{#convert_hyperlinks}}{{ l.a_changelog }}{{/convert_hyperlinks}}
          </div>
          {{^l.onesignal_appid}}
          <div class="row center red-text" style="margin-top:1em">
            <div class="container">
              {{#convert_hyperlinks}}{{ l.a_onesignal_missing }}{{/convert_hyperlinks}}
            </div>
          </div>
          {{/l.onesignal_appid}}
        </div>
      </div>
    </div>

    <!-- PageSpeed Insights -->
    <div class="col l4 m6 hide-on-small-only">
      <div class="row center extrapadding">
        <h5>{{ l.a_optimizations }}&nbsp;<span id="psi_ping" class="mono">&nbsp;</span></h5>
        <p id="a_ps_insights_info"></p>
        <div id="psi_row" class="row center">
          <a id="a_ps_insights" class="tooltipped waves-effect orange waves-light btn" data-position="top"
            data-tooltip="{{ l.a_ps_insights_ttip }}">
            <i class="fab fa-google"></i>
            {{ l.a_ps_insights }}</a>
        </div>
      </div>

      <!-- icon buttons -->
      <h4 class="center">
        <a rel="noopener" target="_blank" class="tooltipped blue-text text" data-position="top"
          data-tooltip="{{ l.a_github_ttip }}" href="https://github.com/gscloud"><i class="fab fa-git"></i></a>
        <a rel="noopener" target="_blank" class="tooltipped lime-text text" data-position="top"
          data-tooltip="{{ l.a_sysinfo_ttip }}" href="https://sys.gscloud.cz/index.php?disp=bootstrap"><i
            class="fas fa-server"></i></a>
        {{#l.a_lasagna_manual_disable}}
        <a rel="noopener" target="_blank" class="tooltipped grey-text text" data-position="top"
          data-tooltip="{{ l.a_lasagna_manual_ttip }} &mdash; {{ l.a_notavailable_ttip }}"><i
            class="fas fa-dna"></i></a>
        {{/l.a_lasagna_manual_disable}}
        {{^l.a_lasagna_manual_disable}}
        <a rel="noopener" target="_blank" class="tooltipped purple-text text" data-position="top"
          data-tooltip="{{ l.a_lasagna_manual_ttip }}" href="{{ l.a_lasagna_manual_url }}"><i
            class="fas fa-dna"></i></a>
        {{/l.a_lasagna_manual_disable}}
        <a rel="noopener" target="_blank" class="tooltipped white-text text" data-position="top"
          data-tooltip="{{ l.a_locale_template_ttip }}" href="{{ l.a_locale_template_url }}"><i
            class="fas fa-clone"></i></a>
        {{#google_drive_backupxxx}}
        <a rel="noopener" target="_blank" class="tooltipped green-text text" data-position="top"
          data-tooltip="{{ l.a_google_backup_ttip }}" href="{{ google_drive_backup }}"><i
            class="fas fa-warehouse"></i></a>
        {{/google_drive_backupxxx}}
      </h4>
    </div>

  </div>

  <!-- emojis -->
  <div id="emojis" class="row center" style="display:none">{{>emoji}}</div>
</div>

<script>
  (function (w, d, undefined) {

    if (!getCookie("logout")) {
      d.getElementById("admin_main").style.display = "block";
    }
    delCookie("logout");

    if (w.GSC.init) {

      // data
      GSC.data = {};
      GSC.profile = "default";
      GSC.data.multisite_profiles = {{ multisite_profiles_json }};

      // ShowLoader()
      if (!w.GSC.ShowLoader) w.GSC.ShowLoader = function (t) {
        if (!t) return;
        $(t).html(
          '<div class="preloader-wrapper small active"><div class="spinner-layer spinner-blue-only"><div class="circle-clipper left"><div class=circle></div></div><div class=gap-patch><div class=circle></div></div><div class="circle-clipper right"><div class=circle></div></div></div></div>'
        );
      }

      // PingDot()
      if (!w.GSC.PingDot) w.GSC.PingDot = function (dot, status = true) {
        if (!dot) return;
        if (status) status = "green";
          else status = "red";
        $(dot).html("&#8226;").css({
          color: status,
          opacity: 1
        }).fadeTo("slow", 0);
      }

      // GetCsvInfo()
      if (!w.GSC.GetCsvInfo) w.GSC.GetCsvInfo = function () {
        var t = "#a_update_info";
        if (w.GSC.offline) {
          GSC.PingDot("#csv_ping", false);
          return;
        }
        $.get("/admin/GetCsvInfo?" + Date.now(), function (data) {
            GSC.PingDot("#csv_ping");
            var content = "";
            var now = ~~(Date.now() / 1000);
            for (x in data.data) {
              var link = x;
              var sheet = data.data[x]["sheet"];
              var csv = data.data[x]["csv"];
              var lines = data.data[x]["lines"];
              if (sheet) {
                link =
                  '<a rel=noopener target=_blank title="{{ l.a_edit_gsheet_ttip }}" class="green mono white-text bold" href="' +
                  'https://docs.google.com/spreadsheets/d/' +
                  sheet + '/edit#gid=0">&nbsp;<i class="material-icons white-text tiny">edit</i>&#8239;' +
                  x + '&nbsp;</a>&nbsp;&nbsp;&nbsp;<a rel=noopener target=_blank title="{{ l.a_download_csv_ttip }}"' +
                  ' class="bold blue white-text mono" ' +
                  'href="https://docs.google.com/spreadsheets/d/e/' +
                  csv + '/pub?output=csv">&nbsp;<i class="fas white-text fa-cloud-download-alt"></i>&#8239;' +
                  lines + '&nbsp;</a>&nbsp;';
              }
              moment.locale("{{ lang }}");
              content += (link + " {{ l.a_age }}&nbsp;" +
                moment.duration(Math.abs(~~((now - data.data[x]["timestamp"]))), "seconds").humanize() +
                "<br>"
              );
            }
            $(t).html(content);
          })
          .fail(function () {
            GSC.PingDot("#csv_ping", false);
            $(t).html('<i class="material-icons large">mood_bad</i>');
          });
      }

      // GetPSInsights()
      if (!w.GSC.GetPSInsights) w.GSC.GetPSInsights = function () {
        var t = "#a_ps_insights_info";
        if (w.GSC.offline) {
          GSC.PingDot("#psi_ping", false);
          return;
        }
        GSC.ShowLoader(t);

        $.get("/admin/GetPSInsights?" + Date.now(), function (data) {
            GSC.PingDot("#psi_ping");
            $("#psi_row").hide();
            $(t).html('<h2 class="orange-text a_reset a_h2">' + data.data.ruleGroups.SPEED.score +
              "&nbsp;%</h2>");
            $(t).append("numberResources:&nbsp;<span class=bold>" +
              data.data.pageStats.numberResources + "</span> ");
            $(t).append("numberStaticResources:&nbsp;<span class=bold>" +
              data.data.pageStats.numberStaticResources + "</span> ");
            $(t).append("numberJsResources:&nbsp;<span class=bold>" +
              data.data.pageStats.numberJsResources + "</span> ");
            $(t).append("numberCssResources:&nbsp;<span class=bold>" +
              data.data.pageStats.numberCssResources + "</span> ");
            $(t).append("<br>");
            $(t).append("htmlResponseBytes:&nbsp;<span class=bold>" +
              GSC.FormatBytes(data.data.pageStats.htmlResponseBytes) + "</span> ");
            $(t).append("cssResponseBytes:&nbsp;<span class=bold>" +
              GSC.FormatBytes(data.data.pageStats.cssResponseBytes) + "</span> ");
            $(t).append("imageResponseBytes:&nbsp;<span class=bold>" +
              GSC.FormatBytes(data.data.pageStats.imageResponseBytes) + "</span> ");
            $(t).append("<br>");
            $(t).append("numTotalRoundTrips:&nbsp;<span class=bold>" +
              data.data.pageStats.numTotalRoundTrips + "</span> ");
            $(t).append("numRenderBlockingRoundTrips:&nbsp;<span class=bold>" +
              data.data.pageStats.numRenderBlockingRoundTrips + "</span> ");
            $(t).slideDown();
            $("#a_ps_insights").removeAttr("disabled");
          })
          .fail(function () {
            GSC.PingDot("#psi_ping", false);
            $(t).html('<i class="material-icons large">mood_bad</i>').slideDown();
            $("#a_ps_insights").removeAttr("disabled");
          });
      }

      // GSC.AdminUI()
      if (!w.GSC.AdminUI) w.GSC.AdminUI = function () {
        $("#admin_main div").addClass("a_reset");
        $("#admin_main h2").addClass("a_reset a_h2");
        $("#admin_main h4").addClass("a_reset a_h4");
        $("#admin_main h5").addClass("a_reset a_h5");
        $("#admin_main p").addClass("a_reset");
        if (w.GSC.touch) {
          if ($(".tooltipped")) $(".tooltipped").tooltip("destroy");
        }

        $(".summernote").dblclick(function () {
          $(".summernote").unbind("dblclick");
          GSC.DeploySummernote();
        });
      }

      // GSC.DeploySummernote()
      if (!w.GSC.DeploySummernote) w.GSC.DeploySummernote = function () {
        GSC.summernote_on = true;
        $("#a_summernote").text("{{ l.a_save_all }}");
        $("#a_summernote").unbind("click");

        // SAVE ALL
        $("#a_summernote").click(function () {
          if (w.GSC.offline) {  // we are offline
            GSC.PingDot("#summer_ping", false);
            return;
          }
          var id;
          var data = {};
          $(".summernote").each(function (i, obj) { // collect HTML data
            id = $(obj).attr("id")
            if (id) {
              data[id] = $(obj).summernote("code");
            }
            $(obj).summernote("destroy");
          });
          console.log("UpdateArticles write", {data});
          $.post("/admin/UpdateArticles", { // API call
            profile: GSC.profile,
            hash: "{{ request_path_hash }}",
            data: JSON.stringify(data)
          }, function (data) {
            console.log("UpdateArticles result",{data});
          }).done(function() {
            GSC.PingDot("#summer_ping");
            GSC.AdminUI();
            $("#a_summernote").html('<i class="fas fa-edit"></i>{{ l.a_summernote }}');
            $("#a_summernote").unbind("click");

            $("#a_summernote").click(function () {
              GSC.ReadArticles(function () {
                GSC.DeploySummernote();
              });
            });
            GSC.summernote_on = false;
          }).fail(function() {
            GSC.PingDot("#summer_ping", false);
            alert("ERROR!");
          });
        });

        var SaveAllButton = function (context) {
          var ui = $.summernote.ui;
          var button = ui.button({
            contents: '<i class="fas fa-save"></i> {{ l.a_save_all }}',
            click: function () {
              $("#a_summernote").click();
            }
          });
          return button.render();
        }

        $(".summernote").summernote({
          lang: {{#langcs}}"cs-CZ"{{/langcs}}{{#langen}}"en-US"{{/langen}},
          codeviewFilter: true,
          codeviewIframeFilter: true,
          dialogsInBody: false,
          disableDragAndDrop: true,
          height: 200,
          callbacks: {
            onChange: function(contents, $editable) {
              $("div.note-btn-group.note-custom > button > i").css("color", "red");
            }
          },
          styleTags: [
            'p', 'blockquote', 'pre', 'h2', 'h3', 'h4', 'h5', 'h6'
          ],
          fontSizes: [
            '8', '9', '10', '11', '12', '14', '16', '18', '24', '36', '48' , '64', '82', '100', '150'
          ],
          toolbar: [
            ["style", ["style", "add-text-tags", "addclass"]],
            ["font", ["bold", "italic", "underline", "fontsize", "fontname", "strikethrough", "superscript", "subscript", "clear"]],
            ["color", ["forecolor", "backcolor", "color"]],
            ["paragraph", ["ul", "ol", "paragraph", "height"]],
            ["table", ["table"]],
            ["insert", ["link", "picture", "video"]],
            ["history", ["undo", "redo"]],
            ["view", ["codeview", "fullscreen"]],
            ["custom", ["saveall"]],
          ],
          buttons: {
            saveall: SaveAllButton
          }
        });
      }

      w.GSC.init.push(function () {
        w.GSC.names.push("Summernote plugins");

        (function(d){"function"===typeof define&&define.amd?define(["jquery"],d):"object"===typeof module&&module.exports?module.exports=d(require("jquery")):d(window.jQuery)})(function(d){d.extend(d.summernote.plugins,{"add-text-tags":function(g){var c=this,f=d.summernote.ui,h=g.options;c.generateBtn=function(a,e){var b=a.slice(0,1).toUpperCase();return f.button({contents:"<"+a+">"+b+"</"+a+">",tooltip:e+" <"+a+">",className:"note-add-text-tags-btn",click:function(b){c.wrapInTag(a)}})};var k=c.generateBtn("del","Deleted text"),l=c.generateBtn("ins","Inserted text"),m=c.generateBtn("small","Fine print"),n=c.generateBtn("mark","Highlighted text"),p=c.generateBtn("var","Variable"),q=c.generateBtn("kbd","User input"),r=c.generateBtn("code","Inline code"),t=c.generateBtn("samp","Sample output");g.memo("button.add-text-tags",function(){return f.buttonGroup([f.button({className:"dropdown-toggle",contents:"<b>+</b> "+f.icon(h.icons.caret,"span"),tooltip:"Additional text styles",data:{toggle:"dropdown"}}),f.dropdown([f.buttonGroup({className:"note-add-text-tags-code",children:[r,t,q,p]}),f.buttonGroup({className:"note-add-text-tags-other",children:[n,m,l,k]})])]).render()});c.areDifferentBlockElements=function(a,c){var b=getComputedStyle(a,null).display,e=getComputedStyle(c,null).display;return"inline"!==b&&"inline"!==e?(console.log("Can't insert across two block elements."),!0):!1};c.isSelectionParsable=function(a,e){if(a.isSameNode(e))return!0;if(c.areDifferentBlockElements(a,e))return!1;var b=a.parentElement,d=e.parentElement;if(a.isSameNode(d)||e.isSameNode(b)||b.isSameNode(d))return!0;console.log("Unable to parse across so many nodes. Sorry!");return!1};c.wrapInTag=function(a){if(window.getSelection){var e=window.getSelection(),b=0<e.rangeCount&&e.getRangeAt(0);if(b.startOffset!==b.endOffset){b=b.cloneRange();var d=b.startContainer.parentElement,f=b.endContainer.parentElement;if(d.isSameNode(f)||c.isSelectionParsable(d,f))a=document.createElement(a),a.appendChild(b.extractContents()),b.insertNode(a),b.selectNodeContents(a),e.removeAllRanges(),e.addRange(b)}}}}})});

        (function(c){"function"===typeof define&&define.amd?define(["jquery"],c):"object"===typeof module&&module.exports?module.exports=c(require("jquery")):c(window.jQuery)})(function(c){c.extend(c.summernote.plugins,{addclass:function(b){"undefined"===typeof b.options.addclass&&(b.options.addclass={});"undefined"===typeof b.options.addclass.classTags&&(b.options.addclass.classTags="btn;hoverable;flow-text".split(";"));var d=c.summernote.ui;(function(a){var b=document.createElement("style");b.innerHTML=a;document.body.appendChild(b)})(".scrollable-menu {height: auto; max-height: 200px; max-width:300px; overflow-x: hidden;}");b.memo("button.addclass",function(){return d.buttonGroup([d.button({className:"dropdown-toggle",contents:'<i class="fa fa-css3"/> '+d.icon(b.options.icons.caret,"span"),tooltip:"toggle CSS class",data:{toggle:"dropdown"}}),d.dropdown({className:"dropdown-style scrollable-menu",items:b.options.addclass.classTags,template:function(a){"string"===typeof a&&(a={tag:"div",title:a,value:a});var b=a.tag;return"<"+b+" "+(a.style?' style="'+a.style+'" ':"")+(a.value?' class="'+a.value+'" ':"")+">"+a.title+"</"+b+">"},click:function(a,d,e){a.preventDefault();e=e||c(a.target).closest("[data-value]").data("value");a=c(b.invoke("restoreTarget"));0==a.length&&(a=c(document.getSelection().focusNode.parentElement,".note-editable"));"undefined"!==typeof b.options.addclass&&"undefined"!==typeof b.options.addclass.debug&&b.options.addclass.debug&&console.debug(b.invoke("restoreTarget"),a,"toggling class: "+e,window.getSelection());a.toggleClass(e)}})]).render()});this.events={"summernote.init":function(a,b){},"summernote.keyup":function(a,b){}};this.initialize=function(){};this.destroy=function(){}}})});

      });

      // admin UI bindings
      w.GSC.init.push(function () {
        w.GSC.names.push("admin UI bindings");

        var profiles = [];
        var params = new window.URLSearchParams(window.location.search);
        var profile = params.get("profile");
        for (var i in GSC.data.multisite_profiles) profiles.push(i);
        if (!profiles.includes(profile)) {
          profile = getCookie("profile");
          if (!profiles.includes(profile)) {
            profile = "default";
          }
        }
        GSC.profile = profile;
        setCookie("profile", profile);
        $("#SiteSelect option[value=" + profile + "]").attr("selected", "selected");
        $("#SiteSelect").formSelect();
        $("#domains").html(GSC.data.multisite_profiles[profile].join(" "));

        $("#SiteSelect").change(function () {
          if (!$("#SiteSelect").val()) return;
          var profile = $("#SiteSelect").val().trim();
          setCookie("profile", profile);
          window.location.href = window.location.pathname + "?profile=" + profile;
        });

        $("#RemoteFnSelect").change(function () {
          if (w.GSC.offline) {
            GSC.PingDot("#sectok_ping", false);
            return;
          }
          if (!$("#RemoteFnSelect").val()) return;
          $.get("/admin/GetUpdateToken?" + Date.now(), function (data) {
            var s = $("#RemoteFnSelect").val();
            var t = data.data[0];
            t = t.replace(/[a-zA-Z]*\?/, s + "?");
            GSC.CopyClipboard(t);
            GSC.PingDot("#sectok_ping");
            M.toast({html: s + " ðŸ’•"});
          }).fail(function () {
            $("#a_security_token").val("N/A");
            GSC.PingDot("#sectok_ping", false);
          });
        });

        $("#a_update").click(function () {
          if (w.GSC.offline) {
            GSC.PingDot("#csv_ping", false);
            return;
          }
          $("#a_update").attr("disabled", "disabled");
          GSC.ShowLoader("#a_update_info");
          setTimeout(function(){$("#a_update").removeAttr("disabled")}, 20E3);
          $.post("/admin/CoreUpdate");
        });

        $("#a_ps_insights").click(function () {
          if (w.GSC.offline) {
            GSC.PingDot("#psi_ping", false);
            return;
          }
          $(this).attr("disabled", "disabled");
          GSC.PingDot("#psi_ping");
          GSC.GetPSInsights();
        });

        $("#a_summernote").click(function () {
          GSC.ReadArticles(function(){GSC.DeploySummernote()});
        });

        $("#a_emoji").click(function () {
          if (!GSC.emojicc) {
            var splitter = new GraphemeSplitter();
            var graphemes = splitter.splitGraphemes($("#emojis").text());
            var arr = graphemes.map(function (x) {
              return '<span class="ccemoji">' + x + '</span>';
            });
            console.log("Emojis and symbols: " + arr.length);
            $("#emojis").html(arr.join(""));
            $(".ccemoji").click(function () {
              var x = $(this).text();
              GSC.CopyClipboard(x);
              M.toast({html: x, classes: "bigemoji"});
            });
            GSC.emojicc = true;
          }
          $("#emojis").toggle("fast");
        });

        $("#a_flush").click(function () {
          if (w.GSC.offline) {
            GSC.PingDot("#csv_ping", false);
            return;
          }
          GSC.GetCsvInfo = function () {};
          $("#a_flush").attr("disabled", "disabled");
          $.post("/admin/FlushCache");
          window.location.reload(true);
        });

        $("#a_logout").click(function () {
          setCookie("logout", "logout", 0);
          if (GSC.offline) {
            window.location.replace("/");
          } else {
            window.location.replace("/logout");
          }
        });

      });

      // CSV timer
      w.GSC.init.push(function () {
        w.GSC.names.push("CSV timer");
        if (!w.GSC.offline) GSC.ShowLoader("#a_update_info");
        setInterval(function(){window.GSC.GetCsvInfo()}, 2500);
      });

      // admin UI
      w.GSC.init.push(function () {
        w.GSC.names.push("admin UI");
        GSC.AdminUI();
      });

    }

  $.get("/admin/GetPSInsights?" + Date.now());

  })(window, document);

</script>

{{>admin_custom}}

<script src="{{ cdn }}/js/moment.min.js" defer></script>
<script src="{{ cdn }}/js/grapheme.min.js" defer></script>
<script src="{{ cdn }}/summernote/summernote-lite.js" defer></script>
<link href="{{ cdn }}/summernote/summernote-lite.css" rel="stylesheet">
{{#langcs}}<script src="{{ cdn }}/summernote/lang/summernote-cs-CZ.min.js" defer></script>{{/langcs}}

{{/admin_group_admin}}
